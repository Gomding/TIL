# 4. 오류

이장에서 배우는 것
- 시스템이 복구할 수 있는 오류와 복구할 수 없는 오류의 구분
- 신속하게 실패하고 분명하게 실패
- 오류를 전달하기 위한 다양한 기법과 선택을 위한 고려 사항

코드가 실행되는 환경은 불안정하다
- 사용자가 잘못된 입력을 제공
- 외부 시스템이 다운
- 자신이 작성한 코드와 다른 개발자가 작성한 코드가 종종 버그를 발생시킬 수 있음

오류는 불가피하다. 모든 것이 잘못될 수 있고 잘못될 것이기 때문에 오류 사례를 신중하게 생각하지 않고는 경고하고 신뢰성 높은 코드를 작성할 수 없다.

오류에 대해 생각할 때, `소프트웨어가 작동을 계속할 수 있는 오류` 와 `작동을 계속할 합리적인 방법이 없는 오류` 를 구분하는 것이 유용할 때가 많다.

## 복구 가능성

특정 오류가 발생한 경우 복구할 수 있는 현실적인 방법이 있는지 판단

오류가 발생했을 때 무엇을 할 것인지 결정하기 위해서는 자신의 코드가 어떻게 사용될지 신중하게 생각해야 한다.

### 복구 가능한 오류
오류가 발생해도 사용자가 알아채지 못하도록 적절히 처리한다면 작동을 계속할 수 있는 합리적인 방법이 있다.

복구 가능한 오류의 예
- 네트워크 오류: 외부 서비스에 연결할 수 없는 경우는 몇초 후 다시 재시도하여 복구하는 방법이 있다.
- 중요하지 않은 작업 오류: 로깅같은 경우 오류가 발생해도 서비스는 계속 실행해도 될 것이다.

일반적으로 시스템 외부의 무언가에 의해 야기되는 오류에 대해서는 대부분 시스템 전체가 표나지 않고 적절하게 처리하기 위해 노력해야 한다.

### 복구 할 수 없는 오류
오류가 발생하고 시스템이 오류를 복구할 수 있는 합리적인 방법이 없을 때가 있다.

- 코드와 함께 추가되어야 하는 리소스가 없다.
- 코드를 잘못 사용한 경우
  - 잘못된 입력 인수로 호출
  - 일부 필요한 상태를 사전에 초기화하지 않음
  - 오타

오류를 복구할 수 있는 방법이 없다면, 유일하게 코드가 할 수 있는 일은 피해를 최소화하고
개발자가 문제를 발견하고 해결할 가능성을 최대화 하는 것이다.

**신속한 실패 & 요란한 실패** 라는 개념은 바로 이에 대한 것이다.

### 호출하는 쪽에서만 오류 복구 가능 여부를 알 때

대부분의 오류는 한 코드가 다른 코드를 호출할 때 발생한다.

오류 상황을 처리할 때는 다른 코드가 자신이 작성한 코드를 호출하는 것과 관련해 다음과 같은 사항을 신중하게 고려해야한다.
- 오류로부터 복구하기를 호출하는 쪽에서 원하는가?
- 그렇다면 오류를 처리할 필요가 있다는 것을 호출하는 쪽에서 어떻게 알 수 있을까?

일반적으로 다음 중 하나라도 해당되는 경우, 함수에 제공된 값으로 인해 발생하는 오류는 호출하는 쪽에서 복구하고자 하는 것으로 간주해야한다.
- 함수가 어디서 호출될지 그리고 호출 시 제공되는 값이 어디서 올지 정확한 지식이 없다.
- 코드가 미래에 재사용될 가능성이 아주 희박하다.

호출하는 쪽에서 오류로부터 복구하기를 원할 것이라고 판단하는 것은 좋은 일이지만.    
오류가 발생할 수 있다는 것조차 인식하지 못한다면 그것을 제대로 처리하지 못할 것이다.   

#### 호출하는 쪽에서 복구하고자 하는 오류에 대해 인지하도록 해야한다.

